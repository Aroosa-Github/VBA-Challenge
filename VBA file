 Sub total_ticker()
    
    Dim ws As Worksheet
    For Each ws In ThisWorkbook.Worksheets
        ws.Activate

        
        Range("I1").Value = "Ticker"
        Range("J1").Value = "Yearly Change"
        Range("K1").Value = "Percent Change"
        Range("L1").Value = "Total Stock Volume"

        
        
        Dim ticker_stock As String
        Dim volume_stock As Double
        volume_stock = 0
        Dim j As Integer
        j = 2

        
        For i = 2 To 43398
            If Cells(i, 1).Value = Cells(i + 1, 1).Value Then
                volume_stock = volume_stock + Cells(i, 7).Value
            ElseIf Cells(i, 1).Value <> Cells(i + 1, 1).Value Then
                volume_stock = volume_stock + Cells(i, 7).Value
                Cells(j, 9).Value = Cells(i, 1).Value
                Cells(j, 12).Value = volume_stock
                j = j + 1
                volume_stock = 0
            End If
        Next i

        Dim year_start As Double
        Dim year_end As Double
        Dim year_change As Double
        Dim percent_change
        Dim k As Integer
        k = 2

        For i = 2 To 43398
            If Right(Cells(i, 2), 4) = "0101" Then
                year_start = Cells(i, 3)
            ElseIf Right(Cells(i, 2), 4) = "1231" Then
                year_end = Cells(i, 6)
                year_change = year_end - year_start
                percent_change = year_change / year_start
                Cells(k, 10).Value = year_change
                If Cells(k, 10).Value > 0 Then
                    Cells(k, 10).Interior.ColorIndex = 4
                ElseIf Cells(k, 10).Value < 0 Then
                    Cells(k, 10).Interior.ColorIndex = 3
                End If
                Cells(k, 11).Value = percent_change
                k = k + 1
            End If
               
        Next i
    
    

        Range("K1").EntireColumn.NumberFormat = "0.00%"

        
        Dim sheet As String
        sheet = ActiveSheet.Name
        Worksheets(sheet).Columns("I:L").AutoFit
        Worksheets(sheet).Columns("O:Q").AutoFit

    
    Next ws
    
    End Sub
    







